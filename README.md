# Wallet Service

Wallet Service ‚Äî —ç—Ç–æ REST API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞–º–∏.  
–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Django REST Framework** –∏ **PostgreSQL**, —É–ø–∞–∫–æ–≤–∞–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –ø–æ–º–æ—â—å—é **Docker Compose**.  

---

## üì¶ –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- Python 3.13
- Django 5
- Django REST Framework
- PostgreSQL 15
- Docker / Docker Compose
- Pytest

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone https://github.com/alex-itx/wallet_app.git
cd wallet_app
```

### 2. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```bash
docker compose up --build
```

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
- `web` ‚Äî Django-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (http://127.0.0.1:8000)
- `db` ‚Äî PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
docker compose run web python manage.py migrate
docker compose run web python manage.py createsuperuser
```

---

## üîë –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è, –∑–∞–¥–∞–Ω–Ω—ã–µ –≤ `docker-compose.yml`:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è       | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ                   |
|------------------|-----------------------|----------------------------|
| `DB_NAME`        | wallet_db             | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö            |
| `DB_USER`        | wallet_user           | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î            |
| `DB_PASSWORD`    | wallet_password       | –ü–∞—Ä–æ–ª—å –ë–î                  |
| `DB_HOST`        | db                    | –•–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Å–µ—Ä–≤–∏—Å)  |
| `DB_PORT`        | 5432                  | –ü–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö           |

---

## üì° API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞
```
GET /api/v1/wallets/<uuid>/
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**
```json
{
  "id": "1a2b3c4d-1234-5678-9012-abcdefabcdef",
  "balance": 1000
}
```

---

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ/—Å–Ω—è—Ç–∏–µ)
```
POST /api/v1/wallets/<uuid>/operation/
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**
```json
{
  "operation_type": "DEPOSIT",  // –∏–ª–∏ "WITHDRAW"
  "amount": 500
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**
```json
{
  "id": "1a2b3c4d-1234-5678-9012-abcdefabcdef",
  "balance": 1500
}
```

**–ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏**
```json
{
  "detail": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤"
}
```

---

## üß™ –¢–µ—Å—Ç—ã

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```bash
docker compose run web pytest -v
```

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
- –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞
- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (DEPOSIT)
- –°–Ω—è—Ç–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ (WITHDRAW)
- –û—à–∏–±–∫—É –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ —Å—Ä–µ–¥—Å—Ç–≤

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
wallet_app/
‚îú‚îÄ‚îÄ wallets/                # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–∫–æ—à–µ–ª—å–∫–∏"
‚îÇ   ‚îú‚îÄ‚îÄ models.py           # –ú–æ–¥–µ–ª–∏ (Wallet)
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py      # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ views.py            # –í—å—é—Ö–∏ (API)
‚îÇ   ‚îú‚îÄ‚îÄ urls.py             # –ú–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ tests/              # –¢–µ—Å—Ç—ã (pytest)
‚îÇ
‚îú‚îÄ‚îÄ wallet_app/             # Django-–ø—Ä–æ–µ–∫—Ç
‚îÇ   ‚îú‚îÄ‚îÄ settings.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ urls.py             # –ì–ª–∞–≤–Ω—ã–π —Ä–æ—É—Ç–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ pytest.ini
‚îî‚îÄ‚îÄ README.md
```

---

## ‚öñÔ∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- –ë–∞–ª–∞–Ω—Å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ **—Ü–µ–ª—ã—Ö —á–∏—Å–ª–∞—Ö** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–ø–µ–π–∫–∞—Ö), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å float/decimal.  
- –û–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **`select_for_update`** –∏ **`F()`-–≤—ã—Ä–∞–∂–µ–Ω–∏–π**, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.  
- –í Docker Compose –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è healthcheck –¥–ª—è Postgres, —á—Ç–æ–±—ã –º–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–∞–∑—ã.  
